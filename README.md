## uniface - 通用人脸识别接口定义及常用算法工具库
---
## 简介
做过几个用到人脸识别的项目，因为各种技术以外的原因，不同项目采用了不同的人脸识别方案，有私有化算法库、也尝试过虹软/百度的离线SDK，发现各家的API用法天差地别，到业务层面的逻辑却大体相同，为了减少代码维护量，就写了这套通用接口和常用算法库。谈不上什么技术含量，也就是定义了一套独立于各家算法的接口，基于接口实现了一些通用逻辑，这样一来，更换基础算法时，只需要基于接口封装一个实例即可，上层业务逻辑代码就可以直接重用了。

## 组成部分
核心组成是uniface包内的UniFaceEngine和UniFaceEngineFactory两个接口。
UniFaceEngine是对各种人脸算法的抽象，UniFaceEngineFactory则是UniFaceEngine的工厂接口。
当需要将某个人脸算法集成到项目中时，采用特定人脸算法实现一个UniFaceEngine实例和一个UniFaceEngineFactory实例即可。

另一个重要组成是uniimage包，其中定义了一些图像数据封装类和几何图形类，并基于这些自定义的类实现了图像缩放、旋转和裁剪。
在java sdk和其他第三方库中，功能相同的类和算法有更专业的实现，之所以“重新发明轮子”是基于两点考虑：
1. 保持一致性。以矩形定义类为例，java.awt中有Rectangle，opencv库中有Rect，android.graphics中有Rect，一些人脸识别SDK中也自定了Rect，为了让uniface的接口定义能在各个不同环境都能直接被引用，也只好自定义一套Uni系列了。图像缩放、旋转、裁剪这几个人脸识别应用需要用到的算法情况也类似。
2. 提高效率。主要体现在图片处理方面，java用Image系列类定义和处理图片，android则用Bitmap和YUMImage，而人脸识别算法一般都需要直接处理RGB数据，用opencv识别人脸是Mat，用tensorflow又换成了TensorBufffer，频繁进行格式转换，效率损失比想象的高得多。例如：tensorflow lite跑facenet模型提取人脸特征，在meta30pro上30ms左右就可以完成，但是如果在Bitmap图上做完旋转、抠图再提取RGBA格式的像素数据再转成BGR数据，这个过程的耗时可以超过50ms，因此自定义了简单的图像类，便于直接基于RGB数据进行缩放、旋转、裁剪等操作，一来只需进行一次格式转换，二来针对单一数据格式实现的算法实测比android或java图形库的大算法也要快那么一丢丢。

uniface.util包内基于UniFaceEngine接口实现了一些常用人脸识别通用逻辑，包括：对UniFaceEngine进行池化处理的工厂类（解决多线程安全调用问题）、并发识别、并发人脸特征比对、并发人脸特征搜索和一个微型的人脸识别服务。

说明内容还在持续整理中...
